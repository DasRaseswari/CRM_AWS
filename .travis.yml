# safelist
branches:
  only:
  - master
  
language: php
#sudo: required
#dist: trusty
#group: edge
php:
  - '5.6'
  - hhvm

#cache:
directories:
  - src
install:
  - composer
before_script: composer require atoum/atoum
script: vendor/bin/atoum
before_script:
   - chmod 0777 ./src
services:
   - mysql
script:
  - cd ./src/tests
  - phpunit EmailTest.php
  - cd ..
  - cd ..
after_success:
   - mkdir -p codedeploy
   - pwd
   - ls -al
   - zip -r neu-csye6225-Team2-ProjectCRM-${TRAVIS_JOB_NUMBER}.zip src appspec.yml || true
   - ls -al
   - mv neu-csye6225-Team2-ProjectCRM-${TRAVIS_JOB_NUMBER}.zip codedeploy || true
   - ls -al
   - pwd
   - cd codedeploy
   - ls -al
   - pwd
before_deploy:
   - cd ..
deploy:
 - provider: s3
   access_key_id: AKIAJHSK4OXYPAU33SIQ
   secret_access_key:
    secure: BppRcmodPp9HJKrhDxOe/a1+mYZMKl/fc6tKN9QAQ0XNyYm8nDD7VPAWsKhDYVejkIuZhKJanuPKTf079B+umy57QKjc3fwJSECFKzWi4w7bPAG9t4u1hK0kvVX1F1r6JqW3wUCCytnFQYb9HIiKGTD2XP6rUtRCFkk7w7jXrD/AhR94SWlqFM4QdF2bnAsfusmr5rfrFhQfPWG9gnCw/SVIk9NlrqOfGXnGESHNmOpW7C2DDN6cOlAaSBiYiTg/MVgLDx/mW7CGlGvXdnuN+JFY/L/tn0pWgX3Y9lsfe8/qUOLBS9IXxzGsMzL2EOetpGyou4DDldAdZftPx8YtYfY5e72mSgrxxVK3/KuuU127WamGuQangHjRKIu/p8lN4hy47/l5YIaC0Xh9zAG9lpavrQT9VQjFs4ntofoF4gI1oXp/ZjcaGBJAOQ061goyvzNxu4DQA9D3iPM/OneALBVvgRU1byeATqBebUKO14bLY6g9GAdfQihe1YI3X1FyAS3wj7M2qFATIBYAjaQXEYduZM9pCkjOE9pT2O+/JYG/5mZBXVLkf9/vnFB7An8dbW8/dM/Mjyow8Mkl3K4xtWA1jRNdTs6rVmgD4Z0EAqaLsX7gH/FgZ6btfCHan+MM3bpzUJhk4LENL/GRvlgelZDIDNNd292pTpRQKQ7Dcj8=
   local_dir: codedeploy
   bucket: code-deploy2.neu-csye6225-spring2017-team-2.com
   region: us-east-1
   skip_cleanup: true
 - provider: codedeploy
   access_key_id: AKIAJHSK4OXYPAU33SIQ
   secret_access_key:
   bucket: code-deploy2.neu-csye6225-spring2017-team-2.com
   key: neu-csye6225-Team2-ProjectCRM-${TRAVIS_JOB_NUMBER}.zip
   bundle_type: zip
   application: Team2Deployment7
   deployment_group: Team2Deployment7group
   region: us-east-1
   wait-until-deployed: true
